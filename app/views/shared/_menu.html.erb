<% if params[:onboard] %>
  <a class="btn btn-primary" id="tour-0" data-placement="top" data-popover-content="#a0" data-toggle="popover" data-trigger="focus" href="#" tabindex="0"></a>

  <!-- Content for start Tour -->
  <div class="hidden" id="a0">
    <div class="popover-header text-center">
      Travel Feed
    </div>
    <div class="popover-body">
      <div class="travel-feed">
        <p>Welcome to your Nomo FOMO Travel Feed where you’ll be 
            able to see your friend’s new trips and updates!</p>
        <p>Don’t want to miss out on the fun? Click on a trip and request to join!  </p>
      </div>
        <div class="popover-footer">
          <button class="btn pul-left btn-back" disabled>Back</button>
          <ul class="dottes-item">          
            <li><a href="#" class="active-btn"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>          
          </ul>
          <button data-nxtid='#fr-req' data-nxtclass="friend-parent" class="nxtFeed btn pul-right btn-next">Next</button>
        </div> 
    </div>
  </div>

  <!-- Content for Find Friends -->
  <div class="hidden" id="a1">
    <div class="popover-header text-center">
      Friends
    </div>
    <div class="popover-body">
      <div class="travel-feed">
        <p>Head here to:</p>
        <p>Send and respond to friend requests and search for your friends!  </p>
      </div>
        <div class="popover-footer">
          <button class="btn pul-left btn-back backFeed" data-backclass="friend-parent" data-backid="#tour-0" >Back</button> 
          <ul class="dottes-item">          
            <li><a href="#"></a></li>
            <li><a href="#" class="active-btn"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>          
          </ul>
          <button data-nxtid='#cal' data-backid="tour-0" data-nxtclass="cal-parent" class="nxtFeed btn pul-right btn-next">Next</button>
        </div> 
    </div>
  </div>

  <!-- Content for calendar -->
  <div class="hidden" id="a2">
    <div class="popover-header text-center">
      Your Calendar
    </div>
    <div class="popover-body">
      <div class="travel-feed">
        <p>Here you can access and edit all of your trips. </p>
        <p>To view more details or invite friends, just select a trip from the left side bar!</p>
      </div>
        <div class="popover-footer">
          <button class="btn pul-left btn-back backFeed" data-backclass="cal-parent" data-backid="#fr-req">Back</button> 
          <ul class="dottes-item">
            
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>
            <li><a href="#" class="active-btn"></a></li>
            <li><a href="#"></a></li>
           
          </ul>
           <button data-nxtid='#explor' data-nxtclass="explor-parent" data-backid="fr-req" class="nxtFeed btn pul-right btn-next">Next</button>
        </div> 
    </div>
  </div>

  <!-- Content for Explorer -->
  <div class="hidden" id="a3">
    <div class="popover-header text-center">
      Explorer
    </div>
    <div class="popover-body">
      <div class="travel-feed">
        <p>Don't know where to go next? </p>
        <p>Use the "Explorer" to see where your friends are and where they are planning to go!</p>
      </div>
      <div class="popover-footer">
        <button class="btn pul-left btn-back backFeed" data-backclass="explor-parent" data-backid="#cal">Back</button> 
        <ul class="dottes-item">
          
          <li><a href="#"></a></li>
          <li><a href="#"></a></li>
          <li><a href="#"></a></li>
          <li><a href="#" class="active-btn"></a></li>
         
        </ul>
         <button class="nxtFeed btn pul-right btn-next finish-onboard">Finish</button>
      </div> 
    </div>
  </div>
<!-- Modal -->
<div class="modal fade" id="onloading-popup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body text-center">
        <%=image_tag "flags.png" %>
        <h1>Welcome! You’re all set up!</h1>
        <p>We’ve created a quick tour to help you navigate around our site</p>
      </div>
      <div class="modal-footer">
        <a href="#" data-dismiss="modal" class="btn-link finish-onboard">Skip</a>
        <button type="button" id="start-tour" data-dismiss="modal" class="btn btn-primary">Start the Tour!:)</button>
      </div>
    </div>
  </div>
</div>

<% end %>

<%= render partial: "shared/waitlist_modal" %>

<% if public_view? %>
  <nav class="navbar navbar-toggleable-md bg-inverse navbar-inverse fixed-top">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <% if request.query_parameters["excludeAnalytics"] == 'true' %>
      <a href="/?excludeAnalytics=true" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% else %>
      <a href="/" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% end %>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav navbar-nav-left ml-auto">
        <li class="nav-item">
          <%= link_to "Login with Facebook", "/users/auth/facebook", class: "nav-link mt-1 mr-2" %>
        </li>
        <li class="nav-item">
          <%= link_to "Sign-Up It's Free", new_waitlist_path, data: { toggle: "modal", target: "#waitlistModal" }, class: "nav-link mt-1 mr-2" %>
        </li>
      </ul>
    </div>
  </nav>
<% elsif user_signed_in? %>
  <nav class="navbar navbar-toggleable-md bg-inverse navbar-inverse fixed-top">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <% if request.query_parameters["excludeAnalytics"] == 'true' %>
      <a href="/?excludeAnalytics=true" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% else %>
      <a href="/" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% end %>
    <% if params[:controller] != "onboardings"%>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav navbar-left">
          <li class="nav-item">

            <%= link_to friend_requests_path, method: :get, remote: true, class: "btn btn-sm btn-nav add-trip-btn", id: "fr-req", "data-placement": "bottom", "data-popover-content": "#a1","data-toggle": "popover", "data-trigger": "focus", "data-html": "true" do %>
              <i class="fa fa-search"></i>
              Find Friends
              <% if current_user.friend_requests.count > 0 %>
                <span class="badge"><%= current_user.friend_requests.count %></span>
              <% end %>
            <% end %>
          </li>
        </ul>
        <ul class="navbar-nav navbar-nav-left ml-auto">
          <li class="nav-item">
            <%= link_to "Plan a Trip", new_trip_url, class: 'btn btn-sm btn-nav add-trip-btn', id: "plan-a-trip-btn" %>
          </li>
          <li class="nav-item <%= active_class(activities_url) %> <%= active_class(root_url) %>">
            <%= link_to activities_url, class: 'nav-link mt-1' do %>
              <i class="fa fa-newspaper-o"></i> Feed
            <% end %>
          </li>
          <li class="nav-item <%= active_class(trips_url) %>">
            <%= link_to trips_url, class: 'nav-link mt-1',id: "cal", "data-placement": "bottom", "data-popover-content": "#a2","data-toggle": "popover", "data-trigger": "focus", "data-html": "true" do %>
              <i class="fa fa-calendar"></i> Calendar
            <% end %>
          </li>
          <li class="nav-item <%= active_class(explorer_url) %>">
            <%= link_to explorer_url, class: 'nav-link mt-1',id: "explor", "data-placement": "bottom", "data-popover-content": "#a3","data-toggle": "popover", "data-trigger": "focus", "data-html": "true" do %>
              <i class="fa fa-map-marker"></i> Explorer
            <% end %>
          </li>
          <li class="nav-item on-desktop">
            <%= link_to notifications_path, class: "nav-link mt-1", title: 'Notifications', rel: 'popover', 'data-toggle': "popover", "data-html": "true", 'data-placement': 'bottom', 'data-container': '.page-wrapper', id: 'notifications', "data-content": "#{ render partial: 'notifications/index', locals: { notifications: current_user.notifications.order("created_at desc").limit(3) }}", remote: true do %>
              <i class="fa fa-bell"></i>
              
              <% count = current_user.notifications.unread.count %>
              <% if count > 0 %>
                <span id="notification-count" class="badge"><%= count %></span>
              <% end %>
            <% end %>
          </li>
          <li class="nav-item on-mobile <%= active_class(notifications_url) %>">
            <%= link_to notifications_url, class: 'nav-link mt-1' do %>
              <i class="fa fa-bell"></i>
            <% end %>
          </li>
        </ul>
        <ul class="navbar-nav">
          <li class="nav-item navbar-nav-right">
            <%= link_to current_user, method: :get, class: "profile-pic-link" do %>
              <span class="user-dropdown-picture">
                <%= user_photo current_user, class: 'rounded-circle', height: '30px', width: '30px' %>
              </span>
            <% end %>
          </li>
          <li class="nav-item dropdown navbar-nav-right user-navbar-item">
            <a href="#" class="nav-link dropdown-toggle user-dropdown" data-toggle="dropdown">
              <span class="fa fa-caret-down user-dropdown-carret" aria-hidden="true"></span>
            </a>
            <ul class="dropdown-menu dropdown-menu-right dropdown-menu-dark">
              <%= link_to current_user, class:"navbar-dropdown-link", name: "profile", 'aria-haspopup' => true, 'aria-expanded' => false do %>
                <li class="dropdown-item nav-dropdown-item">
                  <span>Profile</span>
                </li>
              <% end %>
              <%= link_to my_settings_path, class:"navbar-dropdown-link" do %>
                <li class="dropdown-item nav-dropdown-item">
                  <span>Settings</span>
                </li>
              <% end %>
              <a href="#" class="navbar-dropdown-link walkthrough-dropdown" data-toggle="modal" data-target="videoWalkthroughModal">
                <li class="dropdown-item nav-dropdown-item" <% if [nil,3].include? current_user.viewed_walkthrough %> id="not-viewed-walkthrough" <% end %>>
                  <span>Walkthrough</span>
                </li>
              </a>
              <%= link_to destroy_user_session_path, class:"navbar-dropdown-link", method: :delete, id: "sign_out" do %>
                <li class="dropdown-item nav-dropdown-item">
                  <span>Signout</span>
                </li>
              <% end %>
            </ul>
          </li>
        </ul>
      </div>
    <% end %>
  </nav>
<% else %>
  <nav class="navbar navbar-toggleable-md bg-inverse navbar-inverse">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <% if request.query_parameters["excludeAnalytics"] == 'true' %>
      <a href="/?excludeAnalytics=true" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% else %>
      <a href="/" class="navbar-brand nav-logo">
        <img src="https://s3.us-east-2.amazonaws.com/nomofomo-assets/static/images/logo-white.svg" style="height: 25px">
      </a>
    <% end %>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      
      <ul class="navbar-nav ml-auto login-nav">
        <li class="nav-item">
          <% if request.query_parameters["excludeAnalytics"] == 'true' %>
            <a href="/about?excludeAnalytics=true" class="navbar-brand">About Us</a>
          <% else %>
            <a href="/about" class="navbar-brand">About Us</a>
          <% end %>
        </li>
        <% unless params[:controller]=="waitlists" or params[:controller] == "devise/sessions" or params[:controller] == "devise/registrations" %>
          <li class="nav-item">
<!--             <a href="#" data-toggle="modal" data-target="#loginModal" class="navbar-brand">Sign In</a>
 -->            <a href="/users/sign_in"  class="navbar-brand">Sign In</a>
          </li>
          <li class="nav-item">
            <a href="#" data-toggle="modal" data-target="#waitlistModal" class="navbar-brand">Join Waitlist</a>
          </li>
          <li class="nav-item">
            <a href="#" data-toggle="modal" data-target="#waitlistPositionModal" class="navbar-brand">Check Position</a>
          </li>
        <% end %>
      </ul>

      <div class="modal" id="signupModal" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body text-center pv-30">
            <p>
              <strong>Congratulations!</strong> If you’re here you’ve already received your invitation. We’ve cleared your email for access, just sign up below!
            </p>
            <br />
            <p>
              <a class="btn btn-primary btn-sm" href="/users/auth/facebook">
                Sign up with Facebook <i class="fa fa-facebook-square"></i>
              </a>
            </p>
            <p>
              <small class="fb-notice">We will NEVER post without your permission</small>
            </p>
            <p>
              <small>If you haven't received your invite, you can check your spot on the waitlist <a href="#" data-toggle="modal" data-target="#waitlistPositionModal" data-dismiss="modal">here</a></small>
            </p>
          </div>
        </div>
      </div>
    </div>
    </div>
  </nav>
<% end %>

<div class="modal waitlist-modal" id="waitlistPositionModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body text-center pv-40">
        <div class="wlist-text">
          <h1>Check your position</h1>
          <p>Find out how far you are from getting access.</p>
        </div>
        <div class="facebook-signin-container">
          <div class="sign-in-facebook" id="check_waitlist_fb">
            <i class="fa fa-facebook-f"></i>
            <span>Check your Position</span>
          </div>
        </div>
        <div class="strike">
          <span>OR</span>
        </div>
        <p>If you signed up with an email:</p>
        <%= form_tag("/waitlists/check_waitlist_position", :method => "post", id: "search-form") do %>
          <%= email_field_tag :search, params[:search], placeholder: "Email", class: "form-control custom wlist-email" %>
          <%= submit_tag "Check position", class: "btn btn-info login-button" %>
        <% end %>
        
      </div>
    </div>
  </div>
</div>